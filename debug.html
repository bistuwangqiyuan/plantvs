<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æ¸¸æˆè°ƒè¯•å·¥å…·</title>
    <style>
        body {
            font-family: monospace;
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
        }
        .section {
            background: #252526;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #007acc;
        }
        .error { border-left-color: #f48771; }
        .success { border-left-color: #89d185; }
        .warning { border-left-color: #dcdcaa; }
        h2 { margin-top: 0; }
        pre { background: #1e1e1e; padding: 10px; overflow-x: auto; }
        button {
            background: #0e639c;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
        }
        button:hover { background: #1177bb; }
    </style>
</head>
<body>
    <h1>ğŸ› æ¸¸æˆè°ƒè¯•æ§åˆ¶å°</h1>
    
    <div class="section">
        <h2>å¿«é€Ÿè¯Šæ–­</h2>
        <button onclick="runDiagnostics()">ğŸ” è¿è¡Œè¯Šæ–­</button>
        <button onclick="testGame()">ğŸ® æµ‹è¯•æ¸¸æˆé“¾æ¥</button>
        <button onclick="checkFiles()">ğŸ“ æ£€æŸ¥æ–‡ä»¶</button>
    </div>
    
    <div id="results"></div>
    
    <script>
        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `section ${type}`;
            div.innerHTML = `<pre>${message}</pre>`;
            results.appendChild(div);
        }
        
        function runDiagnostics() {
            document.getElementById('results').innerHTML = '';
            
            log('å¼€å§‹è¯Šæ–­æ¸¸æˆ...', 'info');
            
            // æµ‹è¯•1: æ£€æŸ¥å¿…éœ€æ–‡ä»¶
            const requiredFiles = [
                'index.html',
                'styles.css',
                'game.js',
                'entities.js',
                'levels.js',
                'ui.js',
                'storage.js',
                'utils.js'
            ];
            
            log('æ£€æŸ¥å¿…éœ€æ–‡ä»¶...', 'info');
            
            requiredFiles.forEach(file => {
                fetch(file)
                    .then(response => {
                        if (response.ok) {
                            log(`âœ… ${file} - å­˜åœ¨ (${response.headers.get('content-length')} bytes)`, 'success');
                        } else {
                            log(`âŒ ${file} - ä¸å­˜åœ¨ (${response.status})`, 'error');
                        }
                    })
                    .catch(error => {
                        log(`âŒ ${file} - åŠ è½½å¤±è´¥: ${error.message}`, 'error');
                    });
            });
            
            // æµ‹è¯•2: æ£€æŸ¥JavaScriptåŠ è½½
            setTimeout(() => {
                log('\\næ£€æŸ¥JavaScriptå¯¹è±¡...', 'info');
                
                const checks = [
                    { name: 'GAME_CONSTANTS', obj: typeof GAME_CONSTANTS !== 'undefined' },
                    { name: 'PlantType', obj: typeof PlantType !== 'undefined' },
                    { name: 'ZombieType', obj: typeof ZombieType !== 'undefined' },
                    { name: 'Storage', obj: typeof Storage !== 'undefined' },
                    { name: 'LEVELS', obj: typeof LEVELS !== 'undefined' },
                    { name: 'GameEngine', obj: typeof GameEngine !== 'undefined' },
                    { name: 'Plant', obj: typeof Plant !== 'undefined' },
                    { name: 'Zombie', obj: typeof Zombie !== 'undefined' }
                ];
                
                checks.forEach(check => {
                    if (check.obj) {
                        log(`âœ… ${check.name} - å·²å®šä¹‰`, 'success');
                    } else {
                        log(`âŒ ${check.name} - æœªå®šä¹‰ï¼ˆå¯èƒ½è„šæœ¬æœªåŠ è½½ï¼‰`, 'error');
                    }
                });
            }, 1000);
            
            // æµ‹è¯•3: æµè§ˆå™¨æ”¯æŒ
            setTimeout(() => {
                log('\\næ£€æŸ¥æµè§ˆå™¨æ”¯æŒ...', 'info');
                
                const canvas = document.createElement('canvas');
                const hasCanvas = !!canvas.getContext;
                const hasLocalStorage = !!window.localStorage;
                const hasRAF = !!window.requestAnimationFrame;
                
                log(`Canvas 2D: ${hasCanvas ? 'âœ… æ”¯æŒ' : 'âŒ ä¸æ”¯æŒ'}`, hasCanvas ? 'success' : 'error');
                log(`localStorage: ${hasLocalStorage ? 'âœ… æ”¯æŒ' : 'âŒ ä¸æ”¯æŒ'}`, hasLocalStorage ? 'success' : 'error');
                log(`requestAnimationFrame: ${hasRAF ? 'âœ… æ”¯æŒ' : 'âŒ ä¸æ”¯æŒ'}`, hasRAF ? 'success' : 'error');
            }, 1500);
        }
        
        function testGame() {
            log('æ‰“å¼€æ¸¸æˆé¡µé¢è¿›è¡Œæµ‹è¯•...', 'info');
            window.open('https://plantvs.netlify.app', '_blank');
            
            log('\\nè¯·åœ¨æ–°æ ‡ç­¾é¡µä¸­è¿›è¡Œä»¥ä¸‹æµ‹è¯•:', 'warning');
            log('1. ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"æŒ‰é’®\\n2. é€‰æ‹©å…³å¡1\\n3. è§‚å¯Ÿæ˜¯å¦æœ‰æ§åˆ¶å°é”™è¯¯ï¼ˆF12ï¼‰\\n4. å°è¯•ç§æ¤æ¤ç‰©\\n5. è§‚å¯Ÿåƒµå°¸æ˜¯å¦å‡ºç°', 'info');
        }
        
        function checkFiles() {
            log('æ£€æŸ¥æœ¬åœ°æ–‡ä»¶ç»“æ„...', 'info');
            fetch('/')
                .then(r => r.text())
                .then(html => {
                    if (html.includes('æ¤ç‰©å¤§æˆ˜åƒµå°¸')) {
                        log('âœ… index.html æ­£ç¡®åŠ è½½', 'success');
                    } else {
                        log('âŒ index.html å¯èƒ½æœ‰é—®é¢˜', 'error');
                    }
                });
        }
    </script>
</body>
</html>


