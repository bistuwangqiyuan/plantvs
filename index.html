<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="竖屏网页版植物大战僵尸 - 在线免费玩植物大战僵尸游戏">
    <meta name="keywords" content="植物大战僵尸,PVZ,塔防游戏,在线游戏">
    <title>植物大战僵尸 - Plants vs Zombies</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <h1>🌻 植物大战僵尸 🧟</h1>
            <div class="progress mt-3">
                <div id="loadingProgress" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
            </div>
            <p id="loadingText" class="mt-2">资源加载中...</p>
        </div>
    </div>

    <!-- Main Game Container -->
    <div class="game-container">
        <!-- Canvas for game rendering -->
        <canvas id="gameCanvas"></canvas>

        <!-- Main Menu -->
        <div id="mainMenu" class="overlay-menu">
            <div class="menu-content">
                <h1 class="game-title">🌻 植物大战僵尸 🧟</h1>
                <div class="menu-buttons">
                    <button id="btnStartGame" class="btn btn-lg btn-success mb-3">开始游戏</button>
                    <button id="btnGameRules" class="btn btn-lg btn-info mb-3">游戏规则</button>
                    <button id="btnPlantAlmanac" class="btn btn-lg btn-warning mb-3">植物图鉴</button>
                    <button id="btnResetProgress" class="btn btn-lg btn-danger mb-3">重置进度</button>
                </div>
            </div>
        </div>

        <!-- Level Select -->
        <div id="levelSelect" class="overlay-menu" style="display: none;">
            <div class="menu-content">
                <h2>选择关卡</h2>
                <div id="levelList" class="level-list">
                    <!-- Levels will be dynamically generated -->
                </div>
                <button id="btnBackToMenu" class="btn btn-secondary mt-3">返回主菜单</button>
            </div>
        </div>

        <!-- Pause Menu -->
        <div id="pauseMenu" class="overlay-menu" style="display: none;">
            <div class="menu-content">
                <h2>游戏暂停</h2>
                <div class="menu-buttons">
                    <button id="btnResume" class="btn btn-lg btn-success mb-3">继续游戏</button>
                    <button id="btnRestartLevel" class="btn btn-lg btn-warning mb-3">重新开始</button>
                    <button id="btnExitToLevelSelect" class="btn btn-lg btn-secondary mb-3">退出到关卡选择</button>
                </div>
            </div>
        </div>

        <!-- Victory Screen -->
        <div id="victoryScreen" class="overlay-menu" style="display: none;">
            <div class="menu-content victory">
                <h1>🎉 胜利！ 🎉</h1>
                <div id="victoryStats" class="stats-container">
                    <!-- Stats will be filled dynamically -->
                </div>
                <div class="menu-buttons">
                    <button id="btnNextLevel" class="btn btn-lg btn-success mb-3">下一关</button>
                    <button id="btnReplay" class="btn btn-lg btn-warning mb-3">重玩本关</button>
                    <button id="btnVictoryToLevelSelect" class="btn btn-lg btn-secondary mb-3">返回关卡选择</button>
                </div>
            </div>
        </div>

        <!-- Defeat Screen -->
        <div id="defeatScreen" class="overlay-menu" style="display: none;">
            <div class="menu-content defeat">
                <h1>💀 失败 💀</h1>
                <p class="defeat-message">僵尸突破了防线！</p>
                <div class="menu-buttons">
                    <button id="btnRetry" class="btn btn-lg btn-warning mb-3">重试</button>
                    <button id="btnDefeatToLevelSelect" class="btn btn-lg btn-secondary mb-3">返回关卡选择</button>
                </div>
            </div>
        </div>

        <!-- Game Rules Modal -->
        <div id="gameRulesModal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>游戏规则</h3>
                    <button class="btn-close-modal" id="btnCloseRules">&times;</button>
                </div>
                <div class="modal-body">
                    <h4>游戏目标</h4>
                    <p>使用植物抵御僵尸进攻，阻止僵尸到达屏幕左侧边界。消灭所有波次的僵尸即可获得胜利！</p>
                    
                    <h4>阳光系统</h4>
                    <p>阳光是种植植物的货币。天空会定期掉落阳光，向日葵也会生产阳光。点击阳光即可收集。</p>
                    
                    <h4>植物种植</h4>
                    <ol>
                        <li>点击上方的植物卡片选择要种植的植物</li>
                        <li>点击游戏区域的空格子完成种植</li>
                        <li>每种植物需要消耗一定数量的阳光</li>
                        <li>植物种植后有冷却时间</li>
                    </ol>
                    
                    <h4>胜利条件</h4>
                    <p>消灭所有波次的僵尸</p>
                    
                    <h4>失败条件</h4>
                    <p>任意僵尸到达屏幕左侧边界</p>
                    
                    <h4>操作指南</h4>
                    <ul>
                        <li>鼠标点击或触屏点击进行操作</li>
                        <li>点击暂停按钮可暂停游戏</li>
                        <li>长按植物卡片查看详细信息</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Plant Almanac Modal -->
        <div id="plantAlmanacModal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>植物图鉴</h3>
                    <button class="btn-close-modal" id="btnCloseAlmanac">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="plantAlmanacList" class="plant-almanac-grid">
                        <!-- Plants will be dynamically generated -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Plant Detail Modal -->
        <div id="plantDetailModal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="plantDetailName">植物详情</h3>
                    <button class="btn-close-modal" id="btnClosePlantDetail">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="plantDetailContent">
                        <!-- Plant details will be filled dynamically -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Reset Progress Confirmation -->
        <div id="resetConfirmModal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>确认重置</h3>
                </div>
                <div class="modal-body">
                    <p>确定要重置所有进度吗？此操作不可撤销。</p>
                    <div class="modal-buttons">
                        <button id="btnConfirmReset" class="btn btn-danger">确定</button>
                        <button id="btnCancelReset" class="btn btn-secondary">取消</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Landscape Warning -->
        <div id="landscapeWarning" class="landscape-warning" style="display: none;">
            <div class="landscape-content">
                <h2>📱 请使用竖屏模式</h2>
                <p>为获得最佳体验，请将设备旋转至竖屏模式</p>
            </div>
        </div>

        <!-- Tooltip -->
        <div id="tooltip" class="tooltip-popup" style="display: none;">
            <div id="tooltipContent"></div>
        </div>
    </div>

    <!-- JavaScript files in dependency order -->
    <script src="utils.js"></script>
    <script src="storage.js"></script>
    <script src="entities.js"></script>
    <script src="levels.js"></script>
    <script src="ui.js"></script>
    <script src="game.js"></script>
</body>
</html>

